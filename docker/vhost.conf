<VirtualHost *:80>
	ServerAdmin app@secureaks.com
	ServerName localhost

	DocumentRoot /app/public

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	# Redirection de tout le trafic HTTP vers HTTPS
	RewriteEngine On
	RewriteCond %{HTTPS} off
	RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</VirtualHost>

<VirtualHost *:443>
	ServerAdmin app@secureaks.com
	ServerName localhost

	DocumentRoot /app/public

	ErrorLog ${APACHE_LOG_DIR}/error.log
	CustomLog ${APACHE_LOG_DIR}/access.log combined

	# Configuration SSL
	SSLEngine on
	SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem
	SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key

	# Paramètres de sécurité SSL recommandés
	SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
	SSLHonorCipherOrder on
	SSLCompression off
	SSLOptions +StrictRequire

	# Protection contre les attaques MIME-sniffing
	Header always set X-Content-Type-Options "nosniff"

	# Protection contre le clickjacking
	Header always set X-Frame-Options "SAMEORIGIN"

	# Protection XSS
	Header always set X-XSS-Protection "1; mode=block"
</VirtualHost>